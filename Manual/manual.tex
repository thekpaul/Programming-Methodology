\documentclass[10pt,openany,a4pper]{book}
\usepackage[margin=1in,top=1.25in]{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage[newfloat]{minted}
\usepackage[onehalfspacing]{setspace}
\usepackage{amsmath,amssymb,mathtools,kotex,enumitem,graphicx,fancyhdr,etoolbox,
    tikz,tgpagella,pgf,caption,import,framed,xparse,multicol,xcolor,framed}

\definecolor{light-gray}{rgb}{0.9,0.9,0.9}

\makeatletter
\@addtoreset{chapter}{part}
\makeatother

\pagestyle{fancy}
    \fancypagestyle{styletoc} {%
        \fancyhf{}
        \fancyhead[RE,LO]{\textsc{Table of Contents}}
        \fancyhead[LE,RO]{\thepage}
        \fancyfoot[C]{Programming Methodology with C++}
        \renewcommand{\headrulewidth}{0.5pt}
        \renewcommand{\footrulewidth}{0.5pt}
    }
    \fancypagestyle{stylemain} {%
        \fancyhf{}
        \fancyhead[RE,LO]{\textsc{\nouppercase{\leftmark}}}
        \fancyhead[LE,RO]{\thepage}
        \fancyfoot[C]{Programming Methodology with C++}
        \renewcommand{\headrulewidth}{0.5pt}
        \renewcommand{\footrulewidth}{0.5pt}
    }
    \fancypagestyle{plain} {
        \fancyhf{}
        \renewcommand{\headrulewidth}{0pt}
        \renewcommand{\footrulewidth}{0pt}
    }

\def\cpp{../cpp}
\def\alg{../algorithms}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
    \node[shape=circle,draw,inner sep=0.5pt] (char) {\footnotesize{#1}};}
} \newcommand{\byte}[1][]{\ensuremath\,\mathrm{#1B}}
\setminted{fontsize=\small, xleftmargin=0.25in, linenos, breaklines}
\setlength{\parindent}{0pt}
\setcounter{tocdepth}{1} % Show only up to SECTIONs

\setlist[enumerate,1]{label=\arabic*.,leftmargin=0.2in}
\setlist[enumerate,2]{label=\arabic*),leftmargin=0.2in}
\setlist[enumerate,3]{label=\protect\circled{\arabic*},leftmargin=0.2in}
\setlist[enumerate,4]{label=\alph*.,leftmargin=0.2in}

\AtBeginDocument{%
    \setlength\abovedisplayskip{2pt}
    \setlength\belowdisplayskip{2pt}
    \setlength\abovedisplayshortskip{2pt}
    \setlength\belowdisplayshortskip{2pt}
}

\ExplSyntaxOn
\NewDocumentCommand \imc { o } {
    \IfNoValueTF{#1} {
        \mintinline{cpp}
    } {
        \mintinline[#1]{cpp}
    }
}
\SetupFloatingEnvironment{listing}{name=Code}
\captionsetup[listing]{aboveskip=0pt,belowskip=0pt,format=hang,font=small}

\makeatletter
\patchcmd{\minted@colorbg}{\noindent}{\medskip\noindent}{}{}
\apptocmd{\endminted@colorbg}{\par\medskip}{}{}
\makeatother

%\newcounter{mintcpp}[chapter]
\NewDocumentCommand \imb { o o m o } {
  % \begin{framed}
  %     \refstepcounter<++>
    \IfNoValueTF{#2} {
        \IfNoValueTF{#1} {
            \inputminted{cpp}{#3}
        } {
            \inputminted[firstline=#1,lastline=#1]{cpp}{#3}
        }
    } {
        \inputminted[firstline=#1,lastline=#2]{cpp}{#3}
    } \IfValueTF{#4} {
        \captionof{listing}{#4}
    } { }
  % \end{framed}
} \ExplSyntaxOff

\begin{document}
\begin{titlepage}
    \title{Programming Methodology\\{\Large with C++}}
    \author{Paul Kim}
    \date{powered by \LaTeXe{}}
\maketitle
\end{titlepage}
\pagestyle{styletoc}
\tableofcontents
\newpage

\part{Algorithms}
\pagestyle{stylemain}
\import{../Algorithms/}{01_tca}
\import{../Algorithms/}{02_maxsubarray}
\import{../Algorithms/}{03_sorting}
\import{../Algorithms/}{04_rotatedarray}
\import{../Algorithms/}{05_kthsmall}
\import{../Algorithms/}{06_closestpair}
\import{../Algorithms/}{07_rodcutting}
\import{../Algorithms/}{08_assemblyline}
\import{../Algorithms/}{09_matrixchain}

\part{C++}

\import{../Cpp/}{01_varandclass}
\import{../Cpp/}{02_functions}
\import{../Cpp/}{03_iosheader}
\import{../Cpp/}{04_arrandpoint}
\import{../Cpp/}{05_oop}
\import{../Cpp/}{06_defclass}
\import{../Cpp/}{07_memfunc}
\import{../Cpp/}{08_namespace}
\import{../Cpp/}{09_condestruct}
\import{../Cpp/}{10_pubprivfriend}
\import{../Cpp/}{11_copyconstruct}
\import{../Cpp/}{12_operover}
\import{../Cpp/}{13_protectpriv}
\import{../Cpp/}{14_virtualfunc}
\import{../Cpp/}{15_purevirtual}
\import{../Cpp/}{16_reusemem}
\import{../Cpp/}{17_functiontemplate}
\import{../Cpp/}{18_classtemplate}
\import{../Cpp/}{19_membertemplate}
\import{../Cpp/}{20_genericalg}
\import{../Cpp/}{21_multiinherit}
\import{../Cpp/}{22_operatoroverload}
\import{../Cpp/}{23_functors}
\import{../Cpp/}{24_preprocessor}

\end{document}
